function ezb(B,C,A){EZB.Log("INFO","OLD ezb() call");if(ezb.arguments.length==0){if(EZB.Settings.options.indexOf("disableEZBuy")==-1){EZB.Instance.Process()}else{EZB.Log("WARN:global","DisableEZBuy is set!!!");ezb=function(){}}}else{var D=EZB.Instances.length;EZB.Log("WARN:global","for ezb() with given Pjson");EZB.Context.ForcedDisplayId=A;EZB.Config.Initial=B;EZB.Instance._Init();EZB.Instances[D]={this_i:D,products:window.partnr,style:window.guistyle,id:A,gid:A};EZB.Render.Trigger(C,D)}}EZB.Instances=[];EZB.Requests=[];EZB.RequestMaxProd=30;EZB.Settings=window.EZB.Settings||{};EZB.Loaded=window.EZB.Loaded||{};EZB.Loaded.Defered=false;EZB.Config={};EZB.Paths=window.EZB.Paths||{};EZB.Paths.addBasket=EZB.Paths.php+"/addbasket.php";EZB.Paths.logoClick=EZB.Paths.php+"/logo.php";EZB.Paths.logoFolder="/ezbuy/html/img/logos/";EZB.Clean=function(){EZB.Instances.length=0;EZB.Requests.length=0};EZB.Utils.JSONcopy=function(A){for(var B in A){this[B]=((A[B] instanceof Object)&&!(A[B] instanceof Array))?new EZB.Utils.JSONcopy(A[B]):A[B]}};EZB.Utils.insertRemoteCSS=function(A){EZB.Log("INFO:EZB.Utils.InsertRemoteCSS:",A);document.write(['<link TYPE="text/css" REL="STYLESHEET" HREF="',A,'"></link>'].join(""))};EZB.Utils.injectRemoteCSS=function(B,D){var A=D||window,E=A.document,F=E.createElement("link"),C=E.getElementsByTagName("head")[0];if(C){F.id="ezbuy_css";F.rel="stylesheet";F.href=B;F.type="text/css";C.appendChild(F);EZB.Log("INFO:EZB.Utils.InjectRemoteCSS:",B)}};EZB.Utils.insertRemoteIframe=function(A,B){!B?B="EZB_IFRAME":0;document.domain="hp.com";document.write(['<iframe id="',B,'" style="display:none;position:absolute;" ','src="',A,'" frameborder="0" scrolling="no"></iframe>'].join(""));EZB.Log("INFO:EZB.Utils.InsertRemoteIframe:",B+" "+A)};EZB.Utils.injectRemoteIframe=function(B,F){document.domain="hp.com";var A=window,D=A.document,E=D.createElement("iframe"),C=D.getElementsByTagName("head")[0];if(C){E.src=B;C.appendChild(E);EZB.Log("INFO:EZB.Utils.InsertRemoteIframe2:",F+" "+B)}};EZB.Utils.Defer=function(A){if(EZB.Context.RenderingHookUse){addRenderingHookEvent(false,A);EZB.Log("INFO:EZB.Utils.Defer:","To RenderingHook event")}else{EZB.Utils.AddLoadEvent(A);EZB.Log("INFO:EZB.Utils.Defer:","To onload event")}};EZB.Utils.AddLoadEvent=function(B){var A=window,C=A.onload;if(typeof A.onload!="function"){A.onload=B}else{A.onload=function(){C();B()}}};EZB.Prices={_StartFromGet:function(G,B){var F=0,D=null,C=B.split(";"),A=C.length;for(var E=0;E<A;E++){prod=C[E];if(G[prod]){if(G[prod]&&G[prod].pi){D=parseFloat(G[prod].pi)}}if(D){if(F){if(D<F){F=D}}else{F=D}}}EZB.Log("INFO:EZB.Prices.StartFromGet",[F,"is lowest price for",B].join(""));return(F)},StartFromFormat:function(F,A,D,E){var B=this._StartFromGet(A.Response.results.products.list,D);if(B){var C=this._PriceFormat(F,A,D,B,false,true,E);return(['<br><span class="bold">',C,"</span><br>"].join(""))}else{return(false)}},_PriceFormat:function(A,B,K,M,G,N,J){if(!M){return(false)}var D=null,I=null,H=null,E=null,L="",O=null,R=A.Response.results.standard.config,Q=R.priceformat,F=R.abbrchars,C=R.currencychar,P=R.vat;if(J){O=R.startpricesingle}else{O=R.startpricemultiple}Q?D=Q+"#AB#":D=0;P?E=P:E="";O?prefixr=O.replace("#VAT#",E).replace("#PF#",D):prefixr=0;F?I=F:I="";C?H=C:H="";(J==true||J==false)?L=prefixr:L=D;if(N){L?L=L.replace("#C#",H):0}else{L?L=L.replace("#C#",""):0}L?L=L.replace("#P#",this._digitGroupingDecSymbFormat(A,M)):0;L?L=L.replace("#AB#",I):0;if(G){E?L+=" "+E:0}if(K!=false){O=R.startpricedirect;if(O){if(this._HasHPPrices(B,K)){L=L.replace(/#DIR#/,O)}}}L=L.replace(/#DIR#/,"");EZB.Log("INFO:EZB.Prices._PriceFormat",L);return(L)},_digitGroupingDecSymbFormat:function(B,O){var L=O.toString(),N=B.Response.results.standard.config,P=N.digitgroupingsymbol,D=N.decimalsymbol,A,C=L.split("."),E=C[0];D=D?D:".";decimals=C[1];if(decimals){(decimals.length==1)?decimals+="0":"";var G="",K=decimals.length;for(var F=0;F<K;F++){if(decimals.substring(F,F+1)!="0"){G=true;break}}(!G)?decimals="":""}if(P){var H=0,M="",J=E.length;for(var I=J;I>0;I--){if(H==3){M=P+M;H=1}else{H++}M=E.substring(I-1,I)+M}decimalPart=decimals?D+decimals:"";A=M+decimalPart}else{decimalPart=decimals?D+decimals:"";A=L.replace(/\..*/,decimalPart)}return(A);EZB.Log("INFO:EZB.Prices._digitGroupingDecSymbFormat",A)},SinglePriceFormat:function(E,D){var C="";if(D){var B=E.Response.results.standard.config,A=(B.priceformat?B.priceformat+"#AB#":"");C=A;C?C=C.replace("#VAT#",B.vat).replace("#PF#",A):0;C?C=C.replace("#C#",B.currencychar):0;C?C=C.replace("#P#",D?this._digitGroupingDecSymbFormat(E,D):""):0;C?C=C.replace("#AB#",(B.abbrchars?B.abbrchars:"")):0;C?0:C=""}EZB.Log("INFO:EZB.Prices.SinglePriceFormat",C);return(C)},_HasHPPrices:function(A,F){var D=F.split(";"),G;for(var C=0;C<D.length;C++){var B=D[C];if(A.Response.results.products.list){if(B in A.Response.results.products.list){G=A.Response.results.products.list[B].r;if(G){for(var E=0;E<G.length;E++){if(G[E].t=="hp"){EZB.Log("INFO:EZB.Prices._HasHPPrices","HP found");return(true)}}}}}}EZB.Log("INFO:EZB.Prices._HasHPPrices","HP not found");return(false)}};EZB.Config.CallBack=function(C){EZB.Log("INFO:CALLBACK:EZB.Config.Callback","Config returned:"+C.Response.version+" "+C.Response.status.code+" "+C.Response.status.message);var A=JSON.stringify(C),B=(decodeURIComponent(A)).replace(/\+/g," ").replace(/@P@/g,"+").replace(/@Q@/g,'\\"').replace(/@B@/g,"\\\\");return(JSON.parse(B))};EZB.Config.ApplyFeedConditions=function(Pjson,partnr){var the_p=null,condArray=this.Initial.Response.results.dynamic,the_p=Pjson.Response.results.products.list&&Pjson.Response.results.products.list[partnr],pass=false;if(the_p&&condArray){for(var a in condArray){var condition_to_eval="";if(condArray[a].cond){conditionArray=condArray[a].cond.split("=");var conditionLeft=conditionArray[0],conditionRight=conditionArray[1],res=false;condition_to_eval="(the_p."+conditionLeft+'=="'+conditionRight+'")?res=true:res=false';eval(condition_to_eval);if(res){pass=true;EZB.Log("INFO:EZB.Config._ApplyFeedConditions","Dynamic evaluation OK:"+condition_to_eval);return(this._replaceDynamic(condArray[a]))}}}}if(!pass){EZB.Log("INFO:EZB.Config.ApplyFeedConditions","No Dynamic evaluations");return(this.Initial)}};EZB.Config.ApplyContextConditions=function(){var condArray=this.Initial.Response.results.context,pass=false;if(condArray){for(var a in condArray){var condition_to_eval="";if(condArray[a].cond){conditionArray=condArray[a].cond.split("=");var conditionLeft=conditionArray[0],conditionRight=conditionArray[1],res=false;condition_to_eval="(window."+conditionLeft+'=="'+conditionRight+'")?res=true:res=false';eval(condition_to_eval);if(res){pass=true;EZB.Log("INFO:EZB.Config.ApplyContextConditions","Context evaluation OK:"+condition_to_eval);this._replaceContext(condArray[a])}}}}if(!pass){EZB.Log("INFO:EZB.Config.ApplyContextConditions","No Context evaluations")}};EZB.Config._replaceContext=function(C){var A=C.config,B=this.Initial;for(var D in A){B.Response.results.standard.config[D]=A[D]}};EZB.Config._replaceDynamic=function(E){var A=E.config,B=new EZB.Utils.JSONcopy(this.Initial);for(var D in A){if(D in B.Response.results.standard.config){funcDetails=A[D];for(var F in funcDetails){if(F in B.Response.results.standard.config[D]){for(var C in funcDetails[F]){if(C in B.Response.results.standard.config[D][F]){B.Response.results.standard.config[D][F][C]=funcDetails[F][C]}}}}}}return(B)};EZB.Instance={_Init:function(){if(!this.InitPass){var A=[EZB.req_protocol,"//",EZB.Context.ezbserver,EZB.Settings.css_file,"?version=",EZB.Context.version].join("");EZB.Utils.injectRemoteCSS(A);this.InitPass=true;EZB.Experience()}},_Set:function(B,A){var C=EZB.Instances.length;EZB.Instances[C]={this_i:C,products:B?EZB.Products.Prepare(B):EZB.Products.Prepare(window.partnr),style:A||window.guistyle,id:"EZB_"+C,gid:window.force_ezb_call?force_ezb_call:false,clientID:window.s_prop4||EZB.Context.clientID};EZB.Render.Prepare(C);EZB.Log("INFO:EZB.Instance._Set","EZB_"+C+": ["+EZB.Instances[C].style+"]  ["+EZB.Instances[C].products+"]");return(EZB.Instances[C])},Process:function(D,C){if(EZB.Context.cc==""&&EZB.Context.lc==""){return }this._Init();var F=this._Set(D,C);if(EZB.Context.defer_rendering&&!EZB.Loaded.Defered){if(!this.ProcessPass){EZB.Log("INFO:EZB.Instance.Process","Defering overall EZB processing to the required event");EZB.Utils.Defer(function(){var U=";",L=EZB.Context.ezbpartnr;if(L&&L.split(U).length<EZB.RequestMaxProd){var T=EZB.Requests.length;EZB.Log("INFO:EZB.Instance.Process","Defer triggered, only one pricing request required");EZB.Request.Set(0,EZB.Products.Prepare(EZB.Context.ezbpartnr),EZB.Instances.length);EZB.Request.Run(EZB.Requests[T])}else{EZB.Log("INFO:EZB.Instance.Process","Defer triggered, several pricing request required");var J="",Q=EZB.RequestMaxProd,K=EZB.Instances.length,I=0,P=0,M=0;for(var S=0;S<K;S++){P++;var O=0;if(EZB.Instances[S].products!=false){var H=EZB.Instances[S].products.split(";"),O=H.length}for(var N=0;N<O;N++){if(J.indexOf(H[N])==-1){I++;J+=((I>=2)?";":"")+H[N]}}var G=false;(S==(K-1))?G=true:0;var R=0;if(S!=(K-1)){if(EZB.Instances[S+1].products!=false){R=EZB.Instances[S+1].products.split(U).length}}G=G||(S!=(K-1)&&(I+R)>Q);if(G){var T=EZB.Requests.length;EZB.Request.Set(M,J,P);EZB.Request.Run(EZB.Requests[T]);I=0;J="";P=0;M=S+1}}}})}this.ProcessPass=true}else{var B=";",A=EZB.Context.ezbpartnr;if(EZB.Loaded.Defered&&A&&A.indexOf(F.products)!=-1&&A.split(B).length<EZB.RequestMaxProd){var E=EZB.Requests.length;EZB.Log("INFO:EZB.Instance.Process","Defer Not triggered, but only one pricing request required as page loaded");EZB.Request.Set(0,EZB.Products.Prepare(EZB.Context.ezbpartnr),A.split(B).length);EZB.Request.Run(EZB.Requests[E]);this.ProcessPass=true}else{EZB.Log("INFO:EZB.Instance.Process","Immediate EZB processing, no defering");var E=EZB.Requests.length;EZB.Request.Set(F.this_i,F.products,1);EZB.Request.Run(EZB.Requests[E])}}}};EZB.Request={_Prepare:function(D,A){var C=D.replace(/#PN#/,A),B=EZB.Settings;if(EZB.Context.ezbEppId){C=C.replace(/m_s=smb/,"m_s=hho");C+="&type=hp";EZB.Log("INFO:EZB.Request._Prepare","Restricting type to hp for EppId")}else{if(EZB.Context.forced_channel){C+="&type=ebus";EZB.Log("INFO:EZB.Request._Prepare","Restricting type to channel for forced_channel")}if(EZB.Context.forced_partner){if(EZB.Context.ezbPartnerList){C+="&m_r="+ezbPartnerList;EZB.Log("INFO:EZB.Request._Prepare","Restricting to defined partners for forced_partner "+ezbPartnerList)}}else{if(!(EZB.Context.PLexception&&EZB.Context.PLexception==true)){if(B.partnersExcludeIds){C+="&m_e="+B.partnersExcludeIds.replace(/,/g,";");EZB.Log("INFO:EZB.Request._Prepare","Excluding defined partners as per Settings "+B.partnersExcludeIds.replace(/,/g,";"))}if(B.partnersRestrictIds){C=C+"&m_r="+B.partnersRestrictIds.replace(/,/g,";");EZB.Log("WARN:EZB.Request._Prepare",C);EZB.Log("INFO:EZB.Request._Prepare","Restricting defined partners as per Settings "+B.partnersRestrictIds.replace(/,/g,";"))}}}if((EZB.Context.ezbuyExperience=="direct")&&!B.showDirectTemplate){C+="&type=hp";EZB.Log("INFO:EZB.Request._Prepare","Filtering to hp type only as per direct experience")}}if(B.priceDecimal){C+="&p_format=d";EZB.Log("INFO:EZB.Request._Prepare","Format set to decimal as per Settings")}C+="&clientId="+EZB.Context.clientID;EZB.Log("INFO:EZB.Request._Prepare",C);return C},_Build:function(A){if(A.products){var B=EZB.Urls.dataQueryURL;B=[B,"&callback=","EZB.Requests[",A.this_i,"].Callback","&browse=1","&version=",EZB.Context.version].join("");B=this._Prepare(B,A.products);EZB.Log("INFO:EZB.Request._Build","For: "+A.products+" with CallBack:EZB.Requests["+A.this_i+"].Callback(Pjson)");return(B)}else{EZB.Log("INFO:EZB.Request._Build","not building request as empty products");return(false)}},Run:function(A){EZB.Log("INFO:EZB.Request.Run","Launching prices request for: "+A.products+" with CallBack:EZB.Requests["+A.this_i+"].Callback(Pjson)");var B=this._Build(A);if(B){EZB.Utils.injectRemoteScript(B)}},Set:function(C,B,A){var D=EZB.Requests.length;EZB.Log("INFO:EZB.Request.Set","details: "+D+" with first instance:"+C+" product:"+B+" total instances:"+A);EZB.Requests[D]={this_i:D,first_instance_i:C,products:B,n_instances:A,Callback:function(E){EZB.Log("INFO:CALLBACK:EZB.Request.Set","Callback for request: "+D+" with first instance:"+C+" product:"+B+" total instances:"+A);EZB.Log("INFO:CALLBACK:EZB.Request.Set","Got: "+E.Response.results.products.returned+"/"+(B.split(";")).length);for(var F=this.first_instance_i;F<(this.first_instance_i+EZB.Requests[this.this_i].n_instances);F++){EZB.Render.Trigger(E,F)}}}}};EZB.Products={Prepare:function(partnr){var settings=EZB.Settings,mypartnr=partnr.replace(/#[^;]*/g,"");mypartnr=mypartnr.toUpperCase();mypartnr=mypartnr.replace(/[^;]*PRE[^;]*/g,"");mypartnr=mypartnr.replace(/;;/g,";");mypartnr=mypartnr.replace(/;$/g,"");mypartnr=mypartnr.replace(/^;/g,"");if(EZB.Context.ezbEppId){mypartnrArray=mypartnr.split(";");for(var i=0;i<mypartnrArray.length;i++){mypartnr+=";"+mypartnrArray[i]+"_"+ezbEppId}}if(settings.disablePNs){var disablePNsArray=settings.disablePNs.split(";");for(var i=0;i<disablePNsArray.length;i++){mypartnr=eval("mypartnr.replace(/"+disablePNsArray[i]+'/g,"");');mypartnr=eval('mypartnr.replace(/;;/g,";");')}}if(mypartnr==";"){mypartnr=false}EZB.Log("INFO:EZB.Products.Prepare:",mypartnr);return mypartnr},Set:function(I,F){var B={},A=F.products;if(I.Response.results.products.list&&I.Response.results.products.list[A]){var H=I.Response.results.products.list[A];B={pn:A,id:H.id,ind_f:EZB.Prices.SinglePriceFormat(EZB.Config.Initial,H.pi),ind:H.pi,_ind:H._pi,has_hp:false,has_ebus:false,l:H.l,no_hp_price:H.nop?true:false};if(H.pro&&H.pro.pf&&H.pro.pf==5){B.sp=H.pp}else{B.pro=H.pro;B.pp=H.pp;B.sp=H.sp}var E=-1;if(H.r){myPnJson_r_length=H.r.length;for(var D=0;D<myPnJson_r_length;D++){if(H.r[D].t=="hp"){B.has_hp=true;E=D;break}}if((E==-1&&H.r[0])||(E==0&&H.r[1])||(E>0)){B.has_ebus=true}B.res=new Array();var C=((B.has_hp&&EZB.Context.ezbuyExperience=="channel")?1:0);for(var D=0;D<myPnJson_r_length;D++){if(EZB.Context.ezbuyExperience=="channel"||H.r[D].t=="ebus"){var G=((H.r[D].t=="hp")?0:C);B.res[G]={id:H.r[D].id,pr:H.r[D].pr,mp2b:H.r[D].mp2b,st:H.r[D].st,t:H.r[D].t,n:H.r[D].n,u:H.r[D].u,m:H.r[D].m};B.res[G].pr_f=EZB.Prices.SinglePriceFormat(EZB.Config.Initial,B.res[G].pr);if(H.r[D].t!="hp"){C++}}}}B.sto=(B.has_hp)?H.pi:null;B.hp_mp2b=(B.has_hp)?1:0;B.hp_st=(B.has_hp)?H.r[E].st:null;B.hp_id=(B.has_hp)?H.r[E].id:null;B.hp_n=(B.has_hp)?H.r[E].n:"";B.hp_m=(B.has_hp)?H.r[E].m:"";(B.hp_m.toLowerCase().indexOf("dummy")!=-1)?B.hp_m="":0;B.hp_u=(B.has_hp)?H.r[E].u:"";EZB.Log("INFO:EZB.Products.Set","Setting "+A);F.Pjson=B;return(B)}else{EZB.Log("WARN:EZB.Products.Set","Empty Settings for "+A)}F.Pjson={};return({})}};EZB.Render={Patch:function(){if(window.parent!=self){try{window.parent.document.getElementById("SupplyAccessoryInfo").height=window.parent.document.getElementById("SupplyAccessoryInfo").Document.body.scrollHeight}catch(A){try{window.parent.document.getElementById("SupplyAccessoryInfo").height=window.parent.FFextraHeight+window.parent.document.getElementById("SupplyAccessoryInfo").contentDocument.body.offsetHeight}catch(A){}}}},Prepare:function(id){if(!EZB.Instances[id].gid){document.write('<a name="ezb"'+id+'"></a><a name="#ezb"'+id+'"></a>');document.write('<span id="EZB_'+id+'"></span>');document.write('<a href="#ezb'+eval(id+1)+'"><img src="http://welcome.hp-ww.com/img/s.gif" width="1" height="1" alt="Go to Next product" border="0"></a>')}},_Display:function(E,B){var D;var C=EZB.Instances[E].gid?EZB.Instances[E].gid:"EZB_"+E;D=document.getElementById(C);EZB.Log("INFO:EZB.Render._Display","Display in gid:"+C);if(D&&B){var A=document.createElement("div");A.innerHTML=B;D.appendChild(A);EZB.Log("INFO:EZB.Render._Display","Instance "+E+" displayed")}else{EZB.Log("INFO:EZB.Render._Display","Could not render, empty html or no div")}this.Patch()},Trigger:function(A,B){EZB.Log("INFO:EZB.Render.Trigger","Got Trigger for instance "+B);if(!this.Done){EZB.Config.ApplyContextConditions();EZB.Log("INFO:EZB.Render.Trigger","Applying Context Processing once");this.Done=true}if(EZB.Instances[B]&&EZB.Instances[B].products){EZB.Log("INFO:EZB.Render.Trigger","EZB_"+B+": ["+EZB.Instances[B].style+"]  ["+EZB.Instances[B].products+"]");this._Select(A,B)}else{if(!EZB.Instances[B]){EZB.Instances[B]={}}EZB.Log("WARN:EZB.Render.Trigger","Empty (cleaning) EZB_"+B+": ["+EZB.Instances[B].style+"]  ["+EZB.Instances[B].products+"]")}},_Select:function(A,D){var B=EZB.Instances[D].products,C=EZB.Context.clientID;if(B.indexOf(";")>0){if(A.Response.results.products.list){EZB.Log("INFO:EZB.Render._Select","Rendering StartFrom multiple for instance "+D);this._StartFrom(A,D,false)}else{EZB.Log("WARN:EZB.Render._Select","Not Rendering StartFrom multiple for instance "+D+" as empty list")}}else{if(EZB.Instances[D].style=="small"&&(C=="psc"||C.indexOf("product catalog")!=-1)&&B.indexOf(";")==-1){if(A.Response.results.products.list){EZB.Log("INFO:EZB.Render._Select","Rendering StartFrom single for instance "+D);this._StartFrom(A,D,true)}else{EZB.Log("WARN:EZB.Render._Select","Not Rendering StartFrom single for instance "+D+" as empty list")}}else{EZB.Log("INFO:EZB.Render._Select","Rendering Normal for instance "+D);if(EZB.Context.ezbdisableoptions==true||!(EZB.Settings.options.toLowerCase().indexOf("nostaticdisable")!=-1&&!(A.Response.results.products.list&&A.Response.results.products.list[EZB.Instances[D].products]))){this._Normal(A,D)}EZB.Omniture.SetProducts(EZB.Instances[D])}}},_StartFrom:function(B,D,C){var A=EZB.Prices.StartFromFormat(EZB.Config.Initial,B,EZB.Instances[D].products,C);if(A){EZB.Log("INFO:EZB.Render._StartFrom",A);this._Display(D,A)}else{EZB.Log("WARN:EZB.Render._StartFrom","Start From Price empty (no price/no span id)")}},_Normal:function(A,E){var B={},D={};if(EZB.Context.EppId){B=EzbPn(A,EZB.Instances[E].products+"_BLIND");if(B&&B.ind_f){B.oldprice=B.ind_f}}B=EZB.Products.Set(A,EZB.Instances[E]);D=(EZB.Config.ApplyFeedConditions(A,EZB.Instances[E].products)).Response.results.standard;var C=EZB.Templates.Normal(D,E);this._Display(E,C);EZB.Log("INFO:EZB.Render._Normal:","displaying...:"+C)}};EZB.Omniture={s_products:"",s_products_event:"event18",cpt_ezb_metrics:0,SetProducts:function(A){var B=EZB.Context.ezbuyExperience;if(this.cpt_ezb_metrics){this.s_products+=","}this.cpt_ezb_metrics++;this.s_products=this.s_products+";"+A.products+";0;0;"+this.s_products_event+"=1";if(!A.Pjson||!A.Pjson.has_hp&&(!A.Pjson.pn||A.Pjson.no_hp_price)){this.s_products=this.s_products+"|event40=1"}if(!A.Pjson||A.no_price_indication_display){this.s_products=this.s_products+"|event41=1"}if(A.Pjson&&(A.Pjson.has_hp||(A.Pjson.has_ebus&&B!="direct"))){this.s_products=this.s_products+"|event46=1"}EZB.Log("INFO:EZB.Omniture.SetProducts","updated to:"+this.s_products)}};EZB.Templates={};EZB.Templates.Utils={_IsConfigItemDefined:function(B,A){if(B){if(B[A]){return(B[A])}}return("")},_FormId:function(A){return(["ezb_",A,"_",EZB.Instances[A].products.replace(/-/g,"_"),"_",EZB.Instances[A].style].join(""))},_DeliveryMessage:function(A,C){var B=EZB.Instances[C].Pjson;if(EZB.Settings.showDirectTemplate&&B.has_ebus){return(this._IsConfigItemDefined(A.addbasket,"txt_0"))}if(!B.hp_st){return("")}if(B.hp_st==2){return(this._IsConfigItemDefined(A.addbasket,"txt_0"))}if(B.hp_st==0){return(this._IsConfigItemDefined(A.addbasket,"txt_0"))}if(B.hp_st==5){return(this._IsConfigItemDefined(A.addbasket,"txt_1"))}if(B.hp_st==6){return(this._IsConfigItemDefined(A.addbasket,"txt_2"))}},_CustomizeFormAction:function(){return("")},_BuyPartnerFormAction:function(formId,selected_partner_index){var id_s=selected_partner_index,instanceId=formId.replace(/.*ezb_/g,"").replace(/_.*/g,""),myPjson=EZB.Instances[instanceId].Pjson,myPn=EZB.Instances[instanceId].products,res=myPjson.res,pr=(res[id_s].pr)?res[id_s].pr:(myPjson._ind?myPjson._ind:0),goXmlQuerySep,action="buy";(EZB.Settings.goXmlQuery.indexOf("?")==-1)?goXmlQuerySep="?":goXmlQuerySep="&";var redirect=["http://"+EZB.Settings.kelkooserver,"/",EZB.Settings.goXmlQuery,goXmlQuerySep,"m=",res[id_s].id,"&pn=",myPn,"|1","&url=",res[id_s].u,"&availability=",res[id_s].st,"&price=",res[id_s].pr,"&pkey=",id_s].join(""),js_action=["javascript:",(myPjson.pt?"EZBACTION='"+action+"';":""),"redirectURL='",redirect,"';","ezb_AddBasket('",res[id_s].id,"','",res[id_s].t,"','','",myPn,"|1',",pr,",'",res[id_s].n,"'",",'",EZB.Instances[instanceId].clientID,"'",");"].join("");eval(js_action)},_AddBasketFormAction:function(F){var E=EZB.Instances[F].products,D=EZB.Instances[F].Pjson,C="",G=this._FormId(F);if(D.has_hp){var B=(D.sto)?D.sto:(D._ind?D._ind:0);C="javascript:redirectURL=#add_url#;ezb_AddBasket('#id#','hp','','#partnr#|'+eval('#qty#'),'#price#','#pname#','#clientID#');";var I=["document.forms.EZBox_",G,"_basketForm",".","EZBox_",G,"_ezb_qty.value"].join(""),J="'http://#ezbserver##addBasketUrl#&m=#id#&pn=#partnr#|'+eval('#qty#')+'&m_s=#m_s#&url=&country=#country#&lang=#lang#&availability=#stock#&price='+eval('#qty#')*#price#+'&pkey=1'";C=C.replace(/#add_url#/g,J);C=C.replace(/#ezbserver#/g,EZB.Context.ezbserver);C=C.replace(/#addBasketUrl#/g,EZB.Urls.AddBasket);C=C.replace(/#partnr#/g,E);C=C.replace(/#qty#/g,I);C=C.replace(/#m_s#/g,EZB.Context.m_s);C=C.replace(/#country#/g,EZB.Context.cc);C=C.replace(/#lang#/g,EZB.Context.lc);C=C.replace(/#stock#/g,D.hp_st);C=C.replace(/#id#/g,D.hp_id);C=C.replace(/#partnr#/g,E);C=C.replace(/#price#/g,B);C=C.replace(/#pname#/g,D.hp_n);C=C.replace(/#clientID#/g,EZB.Instances[F].clientID)}else{if(EZB.Settings.showDirectTemplate&&D.has_ebus){var H=D.res;var B=(H[0].pr)?H[0].pr:(D._ind?D._ind:0);(EZB.Settings.goXmlQuery.indexOf("?")==-1)?goXmlQuerySep="?":goXmlQuerySep="&";var A=["http://",EZB.Settings.kelkooserver,"/",EZB.Settings.goXmlQuery,goXmlQuerySep,"m=",H[0].id,"&pn=",E,"|1","&url=",escape(H[0].u),"&availability=",H[0].st,"&price=",B,"&pkey=1"].join("");C=["javascript:redirectURL='",A,"';","ezb_AddBasket('",H[0].id,"','ebus','','",E,"|1',",B,",'",H[0].n,"'",",'",EZB.Instances[F].clientID,"'",");"].join("")}}return(C)}};EZB.Templates.Normal=function(O,b){var C=EZB.Settings.options||"",P=EZB.Logos.json||{},F=EZB.Settings.showDirectTemplate,c=EZB.Urls.elocatorURL,Q=EZB.Context.ezbserver,R=EZB.Instances[b].products,Y=EZB.Instances[b].Pjson,f=EZB.Context.cc,E=EZB.Context.lc,X=EZB.Context.ezbuyExperience,Z=EZB.Templates.Utils._FormId(b),V=O.config,H=V[X],L="",W,A=EZB.Context.EppId,j=EZB.Context.ezbuyPNList,M=EZB.Templates.Utils._IsConfigItemDefined,J=EZB.Instances[b].style;EZB.Instances[b].no_price_indication_display=false;if(!Y.ind_f){EZB.Instances[b].no_price_indication_display=true}if(C.indexOf("disableEZBuy")!=-1||EZB.Instances[b].Pjson.id=="del"){EZB.Instances[b].no_price_indication_display=true;return("")}if(!(C.indexOf("NoPricedisable_HTML")!=-1&&!((Y.ind_f||Y.has_ebus)))){if(X=="direct"&&j&&j.indexOf(R)!=-1&&J.indexOf("small")==-1){var g=H.basketadded.label,S=H.basketadded.txt_0;L+='<div style="width: 180px;padding-bottom:7px;"><strong>'+S+'</strong></div><div><a class="secButtonEnhanced" href="javascript:window.top.location=\''+((checkoutUrl.indexOf("?")==-1)?(checkoutUrl+"?s="+siteId+"&p="+storeId):(checkoutUrl))+"'\">"+g+"</a></div>";return(L)}if(J.indexOf("small")!=-1){if(Y.ind_f){var N=O.config.vat?O.config.vat:"";L+='<div id="EZBox_'+Z+'" class="ezb"><div class="ezb-pricing"><div class="ezb-price">'+Y.ind_f+'</div><div class="ezb-vat">'+N+"</div></div></div>"}return(L)}if(Y.has_hp||Y.has_ebus){W=Y.res}var m=new EZBuy(false,Z),d=false;if((Y.has_hp&&X=="channel")||Y.has_ebus){for(var k=0,I=W.length;k<I;k++){var G=W[k].n;m.addDealer(G,W[k].pr_f,W[k].m?W[k].m.replace("'","\\'"):"",decodeURIComponent(W[k].u),W[k].st<2?true:false,W[k].t);if(W[k].st<2){d=true}}}var U=false;if(Y.pro&&Y.pro.pf==4){U=false}else{if(A&&Y.oldprice){U=true}else{if(J.indexOf("simple")!=-1){U="simple"}else{if(Y.pp&&C.indexOf("promoPriceHighlight")!=-1){U=true}}}}var l=false;if(C.indexOf("promoPriceForce")!=-1&&Y.has_hp&&X!="channel"){l=true}var B={promo:U||l,force_promo:l,ezframeRTL:(C.indexOf("rightToLeftText")!=-1)?true:false};for(var G in B){m[G]=B[G]}var K={logo:(Y.l&&P[Y.l]&&(C.indexOf("showIntelLogo")!=-1||(C.indexOf("showAMDLogo")!=-1)&&Y.l.indexOf("amd")!=-1))?true:false,price_has:Y.ind_f?true:false,priceLasts:(!A&&Y.pro&&Y.pro.ur)?true:false,strikeThrough:(A&&Y.oldprice)?true:((!A&&Y.pro&&Y.pro.pf==1)?true:false),footer:(f!="jp"&&(X!="direct"||F))?true:false,buyFromPartner:((Y.has_ebus&&X!="direct")||(Y.has_hp&&X=="channel"))?true:false,shopping:(!(f=="jp"&&(Y.pp||Y.sp))&&((Y.has_hp&&X!="channel")||(F&&Y.has_ebus)))?true:false,qty:F?false:true,store_available:(f!="jp"&&((Y.has_hp&&X!="channel")||X!="channel"))?true:false,customiseLink:false,basket:true,customisePartner:false,buyPartner:(Y.has_ebus||(Y.has_hp&&X!="direct"))?true:false,localPartner:(C.indexOf("disableElocator_HTML")!=-1)?false:true,limitedStock:d,prff:(window.v_f_prod&&window.v_f_price&&window.v_f_priceless&&v_f_prod[R])?true:false};for(var G in K){m.elements[G]=K[G]}var T={formTarget:((Y.has_hp&&X!="channel")||(F&&Y.has_ebus))?EZB.Templates.Utils._AddBasketFormAction(b):"",localPartner:"javascript:which_screen='"+((Y.has_ebus||(Y.has_hp&&X=="channel"))?"2":"1")+"';redirectURL='"+decodeURIComponent(c)+"';ezb_FindPartner('"+EZB.Instances[b].products+"','"+(Y._ind?Y._ind:"0")+"','"+(EZB.Instances[b].clientID)+"');",buyPartner:(Y.pt&&Y.pt==2)?"EZB.Templates.Utils._CustomizeFormAction":"EZB.Templates.Utils._BuyPartnerFormAction",customiseLink:"",customiseButton:"",customisePartner:"EZB.Templates.Utils._CustomizeFormAction",BuyPartnerClick:"ezb_BuyPartner('"+Y.pn+"','"+Y._ind+"','"+EZB.Instances[b].clientID+"')"};if(F&&!Y.has_ebus){T.formTarget=T.localPartner}for(var G in T){m.actions[G]=T[G]}var D={price:!(Y.pro&&Y.pro.pf==4&&Y.pro.te)?Y.ind_f:Y.pro.te,pricevat:!(Y.pro&&Y.pro.pf==4)?M(V,"vat"):"",intro:m.force_promo?V.force_promo:(f=="jp"&&(Y.pp||Y.sp))?V.promo2:((f=="jp"&&Y.has_ebus)?V.promo:(m.promo?((Y.pro&&Y.pro.h)?Y.pro.h.replace(/'/g,"\\'"):(V.promo?V.promo:(V.intro?V.intro:""))):(V.intro?V.intro:""))),addToBasket:M(H.addbasket,"label"),buyOnlineFromPartner:(J.indexOf("simple")!=-1)?"":((X!="channel"||Y.has_hp)?M(H.viewshops,"txt_0"):M(H.viewshops,"txt_1")),buyFromPartner:M(H.viewshops,"label"),selectAShop:V.lbintro?V.lbintro:"",limitedStock:V.stock?"* "+V.stock:"",buyNow:M(H.buy,"label"),noShopping:V.telnr?M(V,"telnr"):"",customiseLink:M(H.addbasket,"link"),customiseButton:M(H.customize,"txt_0"),customise:M(H.customize,"label"),customisePartner:"config",localPartner:M(H.findreseller,"txt_0"),localPartnerButton:M(H.findreseller,"label"),thankYou:V.bp1?V.bp1:"",leaveHPInfo:V.bp2?V.bp2:"",goNow:M(H.gonow,"label"),oldprice:(A&&Y.oldprice)?Y.oldprice:((Y.pro&&Y.pro.pm)?Y.pro.pm:""),priceinfo:m.force_promo?"":(Y.pro&&Y.pro.te&&Y.pro.pf!=4)?Y.pro.te.replace(/'/g,"\\'"):((!m.promo&&V.pricedescinfo)?V.pricedescinfo.replace(/'/g,"\\'"):""),pricedesc:(J.indexOf("simple")!=-1&&(EZB.Instances[b].clientID.toLowerCase()).indexOf("btbt")!=-1)?"":(V.pricedesc?V.pricedesc:""),pricelasts:(!A&&Y.pro&&Y.pro.ur)?Y.pro.ur.replace(/'/g,"\\'"):"",logosource:P[Y.l]?"http://"+Q+EZB.Paths.logoFolder+P[Y.l].s:"",logolink:(Y.l&&P[Y.l]&&P[Y.l].page)?("http://"+Q+EZB.Paths.logoClick+"?country="+f+"&lang="+E+"&logoID="+Y.l+("&page="+(P[Y.l]?escape(P[Y.l].page):""))):"",logoalt:P[Y.l]?P[Y.l].text:"",delivery:EZB.Templates.Utils._DeliveryMessage(H,b),prff1:m.elements.prff?v_f_price+" "+EZB.Prices.SinglePriceFormat(v_f_prod[R].replace(",",".")):0,prff2:m.elements.prff?v_f_priceless+" "+EZB.Prices.SinglePriceFormat(Y.ind-v_f_prod[R].replace(",",".")):0};if(F&&!Y.has_ebus){D.addToBasket=D.localPartnerButton}if(C.indexOf("rightToLeftText")!=-1){if(Y.ind_f){if(Y.ind_f.indexOf(" ")!=-1){var n=Y.ind_f.split(" ");D.price=n[1]+" "+n[0]}else{if(Y.ind_f.indexOf(V.currencychar)==0){D.price=Y.ind_f.replace(V.currencychar,"")+V.currencychar}else{D.price=V.currencychar+Y.ind_f.replace(V.currencychar,"")}}}(D.intro[0]=="?")?D.intro=D.intro.replace("?","")+"?":""}for(var G in D){m.text[G]=D[G]}var h=document.getElementById("EZB_"+b);m.ezframeWhite=false;if(h&&h.parentNode&&h.parentNode.parentNode&&h.parentNode.parentNode.bgColor&&h.parentNode.parentNode.bgColor.toLowerCase()!="#e7e7e7"){m.ezframeWhite=true}L+="<form></form>";L+=m.draw(true,(C.indexOf("rightToLeftText")!=-1)?true:false);return(L)}else{EZB.Instances[b].no_price_indication_display=true}};EZB.Experience=function(){var A=((EZB.Settings.ForceDirectExperience==true&&window.ezbuyExperience)?"direct":"")||window.ezbuyExperience||"channel";if(EZB.Settings.ForceDirectExperience==true&&A=="direct"&&window.ezbuyExperience&&ezbuyExperience!="direct"){if(window.HPStore_jumpID_detect&&typeof HPStore_jumpID_detect=="function"){HPStore_jumpID_detect(EZB.Context.m_s);printBasket("left",false);printBasket("left_partner",false)}}if(A!="direct"&&A!="neutral"&&A!="channel"){A="channel"}if(A=="epp"||EZB.Settings.showDirectTemplate){A="direct"}EZB.Log("INFO:EZB.Experience.Set",A+" returned ("+EZB.Context.ezbuyExperience+" initialy)");EZB.Context.ezbuyExperience=A};EZB.Urls=(function(){function A(C){C=C.replace(/#PL#/g,EZB.Context.PL);return(C)}function B(){var F=EZB.Context,E=F.storeId,I=F.siteId,H=F.storeUrl,D=F.catalogUrl,G=F.refererUrl;if(!window.storeUrlAdd){storeUrlAdd=H}(EZB.Context.ezbEppId&&EZB.Context.ezbStoreId)?E=ezbStoreId:"";var C=escape([EZB.Paths.addBasket,"?type=hp&siteId=",I,"&clientId=",EZB.Context.clientID,"&storeId=",E,"&storeUrl=",((storeUrlAdd.replace(/&/g,"S_AMP_E")).replace(/\?/g/"S_QM_E")).replace(/#/g,"S_POUND_E"),"&catalogUrl=",encodeURIComponent(encodeURIComponent(D)),"&refererUrl=",encodeURIComponent(encodeURIComponent(G))].join(""));return(C)}return{AddBasket:B(),elocatorURL:A(EZB.Settings.elocatorURL),dataQueryURL:A([EZB.req_protocol,"//",window.ezbserver||EZB.Utils.getQueryStringParameter("ezbserver")||EZB.Settings.HPdataserver,EZB.Settings.HPsearchXmlQuery].join(""))}})();EZB.Patch={};EZB.Patch.Init=function(){EZB.Settings.dataserverSource=EZB.Settings.dataserver;EZB.Settings.searchXmlQuerySource=EZB.Settings.searchXmlQuery};EZB.Patch.Init();EZB.Patch.Onload=function(){};(function(){EZB.Utils.AddLoadEvent(function(){EZB.Loaded.Defered=true;EZB.Patch.Onload()});if(EZB.Context.RenderingHookUse){addRenderingHookEvent(false,function(){EZB.Loaded.Defered=true})}if(EZB.Context.ezbdebug){if(EZB.Context.RenderingHookUse){addRenderingHookEvent(false,function(){EZB.Log("INFO:global","rendering Hook event")})}EZB.Utils.AddLoadEvent(function(){EZB.Log("INFO:global","onload event");if(!EZB.Context.is_ie){var A=window,C=["global","LogReader","EZB.Settings","EZB.Utils","EZB.Experience","EZB.Logos","EZB.Products","EZB.Instance","EZB.Request","EZB.Config","EZB.Render","EZB.Prices","EZB.Omniture"];for(var B=0;B<C.length;B++){(A.parent.EZB&&A.parent.EZB.Log)?A.parent.EZBLogReader.hideSource("FRAME_"+C[B]):EZBLogReader.hideSource("FRAME_"+C[B]);(A.parent.EZB&&A.parent.EZB.Log)?A.parent.EZBLogReader.hideSource(C[B]):EZBLogReader.hideSource(C[B])}}})}})();